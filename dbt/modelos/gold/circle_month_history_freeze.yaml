version: 2

models:
  - name: circle_month_history_freeze
    meta:
      domain: custos_cloud
      layer: gold
      schema: custos_cloud_gold
      owner: observability-platform@willbank.com.br
      openmetadata:
        tags: ['classificacao_da_informacao.publico']
        tier: 'Tier.Tier2'

    description: |
      **Propósito:** Servir como um registro histórico imutável ("congelado") dos custos mensais agregados, garantindo que análises de tendências e relatórios financeiros não sejam afetados por reprocessamentos ou futuras alterações na lógica de atribuição de custos.
      **Escopo:** Armazena um snapshot permanente dos custos passados, detalhados por círculo, provedor (`origin`), mês e tipo de custo. Os dados são definidos manualmente no código SQL.
      **Audiência:** Analistas de FinOps, Engenheiros de Dados e gestores que necessitam de uma base histórica estável e confiável para análises de longo prazo.
      **Processo:** O modelo é construído inteiramente a partir de dados estáticos, que são codificados diretamente na query SQL usando a cláusula `VALUES` dentro de uma CTE. A adição de novos dados históricos ou a correção de valores passados exige uma modificação manual direta neste modelo.
      **Recorrência de atualização:** Manual. Os dados são atualizados apenas quando há necessidade de adicionar ou corrigir o histórico de custos de forma deliberada.

    tags: [gold, will, custos_cloud, finops, history, freeze, snapshot]

    columns:
      - name: circle_id
        description: "O ID do círculo (time) ao qual o custo histórico pertence."
      - name: origin
        description: "O provedor de nuvem ou serviço do custo histórico (ex. 'AWS', 'Datadog', 'MongoDB Atlas')."
      - name: month
        description: "O mês de referência para o qual o custo histórico foi registrado."
      - name: type
        description: "A categoria do custo histórico (ex. 'usage')."
      - name: cost
        description: "O valor monetário do custo histórico que foi deliberadamente 'congelado' neste modelo."
